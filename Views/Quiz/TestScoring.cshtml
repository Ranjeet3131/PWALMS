@{
    ViewData["Title"] = "Test Quiz Scoring";
    var quiz = ViewBag.Quiz as PWALMS.Models.Quiz;
    var questions = ViewBag.QuestionsWithCorrect as List<dynamic>;
}

<div class="container">
    <h2>Test Scoring for: @quiz?.QuizTitle</h2>

    <div class="alert alert-info">
        <h5>Quiz Information</h5>
        <p>Total Questions: @quiz?.TotalQuestions</p>
        <p>Total Marks: @quiz?.TotalMarks</p>
    </div>

    <h4>Question Analysis</h4>
    <table class="table">
        <thead>
            <tr>
                <th>Question</th>
                <th>Correct Answer</th>
                <th>Marks</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            @if (questions != null)
            {
                foreach (var q in questions)
                {
                    <tr>
                        <td>@q.Question</td>
                        <td>
                            @if (q.CorrectOption.Contains("No correct option"))
                            {
                                <span class="badge bg-danger">@q.CorrectOption</span>
                            }
                            else
                            {
                                <span class="badge bg-success">@q.CorrectOption</span>
                            }
                        </td>
                        <td>@q.Marks</td>
                        <td>
                            @if (q.CorrectOption.Contains("No correct option"))
                            {
                                <span class="badge bg-danger">ERROR</span>
                            }
                            else
                            {
                                <span class="badge bg-success">OK</span>
                            }
                        </td>
                    </tr>
                }
            }
        </tbody>
    </table>

    <div class="mt-3">
        <a asp-action="AddQuestions" asp-route-id="@quiz?.QuizID" class="btn btn-warning">
            <i class="fas fa-edit"></i> Edit Questions
        </a>
        <a asp-action="Manage" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Back to Quizzes
        </a>
    </div>
</div>